<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>TODO</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <link href="lib/bootstrap/css/bootstrap.css" rel="stylesheet">
    <link href="lib/bootstrap/css/bootstrap-responsive.css" rel="stylesheet">

    <style>
      .photos {
        padding: 15px;
      }
      .photo {
        width: 25%;
        float: left;
      }
      .photo img {
      }
      #previous, #next {
        display: none;
      }
    </style>
  </head>

  <body data-spy="scroll" data-target=".subnav" data-offset="50">
    <div class="container">

  <header class="jumbotron masthead">
    Header
  </header>

  <div class="photos">
    <script id="content-template" type="example/template">
      <div class="photo">
        <img src="{{url}}" alt="{{title}}" />
        <p>{{caption}}</p>
        <p>{{tags}}</p>
      </div>        
    </script>
  </div>
  <div class="clearfix"></div>
  <button id="previous" class="btn">Previous</button>
  <button id="next" class="btn">Next</button>

  <footer class="footer">
    Footer
  </footer>
  </div>

    <script type="text/javascript" src="lib/underscore/underscore.js"></script>
    <script type="text/javascript" src="lib/jquery/jquery-1.7.1.js"></script>
    <script type="text/javascript">
    var photos = [
      {
        caption: "pickled fruit",
        image: {
          url: "pictures/001.jpg"
        },
        tags: [
          "food",
          "fruit",
          "jamming"
        ]
      },
      {
        caption: "bbq weiners",
        image: {
          url: "pictures/002.jpg"
        },
        tags: [
          "bbq",
          "hot dogs"
        ]
      },
      {
        caption: "power lines",
        image: {
          url: "pictures/003.jpg"
        },
        tags: [
          "sky",
          "farming",
          "landscape",
          "green"
        ]
      },
      {
        caption: "blue flower",
        image: {
          url: "pictures/004.jpg"
        },
        tags: [
          "green",
          "flower"
        ]
      }
      ,{
        caption: "lake sunset",
        image: {
          url: "pictures/005.jpg"
        },
        tags: [
          "lake",
          "sunset",
          "boating"
        ]
      },
      {
        caption: "old car",
        image: {
          url: "pictures/006.jpg"
        },
        tags: [
          "old",
          "classic",
          "car"
        ]
      }
    ];

    var template = $.trim($('#content-template').html());
    var photos_element = $('div.photos');
    var tagBuilder = function(tags) {
      return tags.join(', ');
    };

    var offset = 0;
    var imageLimit = 4;

    function showPictures() {
      $('div.photos').empty();
      var i;
      var end = offset + imageLimit;
      end = Math.min(photos.length, end);
      for (i=offset; i<end; i++) {
        var photo = photos[i]; // show how this isn't scoped as expected
        var temp = template
          .replace(/{{title}}/ig, photo.title)
          .replace(/{{caption}}/ig, photo.caption)
          .replace(/{{tags}}/ig, tagBuilder(photo.tags))
          .replace(/{{url}}/ig, photo.image.url);
        photos_element.append(temp);
      };

      updateButtons();
    }

    function updateButtons() {
      if ((offset + imageLimit) < photos.length){
        $('#next').show();
      } else {
        $('#next').hide();
      }

      if (offset > 0){
        $('#previous').show();
      } else {
        $('#previous').hide();
      }
    }

    $('#next').on('click', function () {
      offset += imageLimit;
      showPictures();
    });

    $('#previous').on('click', function () {
      offset -= imageLimit;
      showPictures();
    });

    showPictures();
    </script>
  </body>
</html>